{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "name": {
      "value": "ReliabilityWorkbookAdvisor"
    },
    "serializedData": {
      "value": "{\n    \"version\": \"Notebook/1.0\",\n    \"items\": [\n        {\n            \"type\": 12,\n            \"content\": {\n              \"version\": \"NotebookGroup/1.0\",\n              \"groupType\": \"editable\",\n              \"items\": [\n                {\n                    \"type\": 9,\n                    \"content\": {\n                        \"version\": \"KqlParameterItem/1.0\",\n                        \"parameters\": [\n                        {\n                            \"id\": \"aa0176d8-14ff-4dc5-9ae7-b8029f565674\",\n                            \"version\": \"KqlParameterItem/1.0\",\n                            \"name\": \"Subscriptions\",\n                            \"type\": 6,\n                            \"isRequired\": true,\n                            \"multiSelect\": true,\n                            \"quote\": \"'\",\n                            \"delimiter\": \",\",\n                            \"typeSettings\": {\n                            \"additionalResourceOptions\": [\n                                \"value::all\"\n                            ],\n                            \"includeAll\": true,\n                            \"showDefault\": false\n                            },\n                            \"defaultValue\": \"value::all\",\n                            \"value\": [\n                            \"value::all\"\n                            ]\n                        },\n                        {\n                            \"id\": \"91aa9ba3-ed60-4472-8dd9-1c2cb6255757\",\n                            \"version\": \"KqlParameterItem/1.0\",\n                            \"name\": \"ResourceGroup\",\n                            \"label\": \"Resource Group\",\n                            \"type\": 2,\n                            \"isRequired\": true,\n                            \"multiSelect\": true,\n                            \"quote\": \"'\",\n                            \"delimiter\": \",\",\n                            \"query\": \"resources\\r\\n| distinct resourceGroup\",\n                            \"crossComponentResources\": [\n                            \"{Subscriptions}\"\n                            ],\n                            \"typeSettings\": {\n                            \"additionalResourceOptions\": [\n                                \"value::all\"\n                            ],\n                            \"showDefault\": false\n                            },\n                            \"defaultValue\": \"value::all\",\n                            \"queryType\": 1,\n                            \"resourceType\": \"microsoft.resourcegraph/resources\"\n                        },\n                        {\n                            \"id\": \"5a4f6d34-9f89-4ef8-b4ee-fb0580ec016d\",\n                            \"version\": \"KqlParameterItem/1.0\",\n                            \"name\": \"Environment\",\n                            \"type\": 2,\n                            \"multiSelect\": true,\n                            \"quote\": \"'\",\n                            \"delimiter\": \",\",\n                            \"query\": \"resources\\r\\n| extend Environment = case(\\r\\ntags.Environment \u003c\u003e \\\"\\\", tags.Environment,\\r\\ntags.environment \u003c\u003e \\\"\\\", tags.environment,\\r\\ntags.Env \u003c\u003e \\\"\\\", tags.Env,\\r\\ntags.env \u003c\u003e \\\"\\\", tags.env,\\r\\ntolower(name) contains \\\"prod\\\", \\\"Production\\\",\\r\\ntolower(name) contains \\\"dev\\\", \\\"Development\\\",\\r\\ntolower(name) contains \\\"qa\\\", \\\"QA\\\",\\r\\ntolower(name) contains \\\"uat\\\", \\\"UAT\\\",\\r\\ntolower(name) contains \\\"sit\\\", \\\"SIT\\\",\\r\\ntolower(name) contains \\\"test\\\", \\\"Test\\\",\\r\\n\\\"Undefined\\\")\\r\\n| distinct Environment\",\n                            \"crossComponentResources\": [\n                            \"{Subscriptions}\"\n                            ],\n                            \"typeSettings\": {\n                            \"additionalResourceOptions\": [\n                                \"value::all\"\n                            ]\n                            },\n                            \"defaultValue\": \"value::all\",\n                            \"queryType\": 1,\n                            \"resourceType\": \"microsoft.resourcegraph/resources\"\n                        },\n                        {\n                            \"id\": \"9d6afcdc-172c-4bef-8bab-dc372c5d3bb4\",\n                            \"version\": \"KqlParameterItem/1.0\",\n                            \"name\": \"TagName\",\n                            \"label\": \"Tag Name\",\n                            \"type\": 2,\n                            \"query\": \"Resources\\r\\n| where tags != '' and tags != '[]'\\r\\n| mvexpand tags\\r\\n| extend tagName = tostring(bag_keys(tags)[0])\\r\\n| distinct tagName\\r\\n| sort by tagName asc\",\n                            \"crossComponentResources\": [\n                            \"{Subscriptions}\"\n                            ],\n                            \"typeSettings\": {\n                            \"additionalResourceOptions\": []\n                            },\n                            \"queryType\": 1,\n                            \"resourceType\": \"microsoft.resourcegraph/resources\",\n                            \"value\": null\n                        },\n                        {\n                            \"id\": \"95781001-338b-4ed3-81dc-ce16f2a98bf0\",\n                            \"version\": \"KqlParameterItem/1.0\",\n                            \"name\": \"TagValue\",\n                            \"label\": \"Tag Value\",\n                            \"type\": 2,\n                            \"query\": \"Resources\\r\\n| mvexpand tags\\r\\n| extend tagName = tostring(bag_keys(tags)[0])\\r\\n| extend tagValue = tostring(tags[tagName])\\r\\n| where tags != '' and tags != '[]' and tostring(bag_keys(tags)[0]) == '{TagName}'\\r\\n| distinct tagValue\\r\\n| sort by tagValue asc\",\n                            \"crossComponentResources\": [\n                            \"{Subscriptions}\"\n                            ],\n                            \"typeSettings\": {\n                            \"additionalResourceOptions\": []\n                            },\n                            \"queryType\": 1,\n                            \"resourceType\": \"microsoft.resourcegraph/resources\",\n                            \"value\": null\n                        },\n                        {\n                            \"id\": \"e929bc01-08ec-45fe-bc6a-4e0267460dfa\",\n                            \"version\": \"KqlParameterItem/1.0\",\n                            \"name\": \"SLA\",\n                            \"label\": \"Show SLA\",\n                            \"type\": 10,\n                            \"description\": \"This will show the SLA information for the focus area\",\n                            \"isRequired\": true,\n                            \"typeSettings\": {\n                            \"additionalResourceOptions\": [],\n                            \"showDefault\": false\n                            },\n                            \"jsonData\": \"[{ \\\"value\\\": \\\"Yes\\\", \\\"label\\\": \\\"Yes\\\", \\\"selected\\\":true},\\r\\n {\\\"value\\\": \\\"No\\\", \\\"label\\\": \\\"No\\\"}]\"\n                        },\n                        {\n                            \"id\": \"9581cbc6-0f0f-42be-8ae8-6fe94de00ab8\",\n                            \"version\": \"KqlParameterItem/1.0\",\n                            \"name\": \"Help\",\n                            \"label\": \"Show Help\",\n                            \"type\": 10,\n                            \"isRequired\": true,\n                            \"typeSettings\": {\n                            \"additionalResourceOptions\": []\n                            },\n                            \"jsonData\": \"[{\\\"value\\\": \\\"Yes\\\", \\\"label\\\": \\\"Yes\\\", \\\"selected\\\":true },\\r\\n {\\\"value\\\": \\\"No\\\", \\\"label\\\": \\\"No\\\"}]\"\n                        }\n                        ],\n                        \"style\": \"pills\",\n                        \"queryType\": 0,\n                        \"resourceType\": \"microsoft.operationalinsights/workspaces\"\n                    },\n                    \"name\": \"parameters - 13\"\n                },\n                    {\n                      \"type\": 1,\n                      \"content\": {\n                        \"json\": \"\u003e Azure Advisor analyzes your configurations and usage telemetry and offers personalized, actionable recommendations to help you optimize your Azure resources for reliability, security, operational excellence, performance, and cost.\\r\\n\\r\\n* Azure Advisor is available automatically without any configuration.\\r\\n* The table in this workbook specifically relate to any reliability recommendations that may apply to the selected subscription(s).\\r\\n* Filter advisor recommendations using the subscriptions parameter as required.\",\n                        \"style\": \"info\"\n                      },\n                      \"conditionalVisibility\": {\n                        \"parameterName\": \"Help\",\n                        \"comparison\": \"isEqualTo\",\n                        \"value\": \"Yes\"\n                      },\n                      \"name\": \"Advisor Help\"\n                    },\n                    {\n                      \"type\": 3,\n                      \"content\": {\n                        \"version\": \"KqlItem/1.0\",\n                        \"query\": \"advisorresources\\n| extend Category = tostring(properties.category)\\n| extend Description = tostring(properties.shortDescription.problem)\\n| extend ImpactedField = tostring(properties.impactedField)\\n| extend ImpactedValue = tostring(properties.resourceMetadata.resourceId)\\n| extend Impact = tostring(properties.impact)\\n| extend LastUpdated = tostring(properties.lastUpdated)\\n| project Impact, ImpactedField, ImpactedValue, Description, resourceGroup, subscriptionId, Category, LastUpdated\\n| where Category == \\\"HighAvailability\\\"\\n| where resourceGroup in ({ResourceGroup})\",\n                        \"size\": 3,\n                        \"title\": \"Advisor - Reliability\",\n                        \"showExportToExcel\": true,\n                        \"queryType\": 1,\n                        \"resourceType\": \"microsoft.resourcegraph/resources\",\n                        \"crossComponentResources\": [\n                          \"{Subscriptions}\"\n                        ],\n                        \"gridSettings\": {\n                          \"formatters\": [\n                            {\n                              \"columnMatch\": \"$gen_group\",\n                              \"formatter\": 13,\n                              \"formatOptions\": {\n                                \"linkTarget\": \"Resource\",\n                                \"showIcon\": true\n                              }\n                            },\n                            {\n                              \"columnMatch\": \"Impact\",\n                              \"formatter\": 18,\n                              \"formatOptions\": {\n                                \"thresholdsOptions\": \"colors\",\n                                \"thresholdsGrid\": [\n                                  {\n                                    \"operator\": \"==\",\n                                    \"thresholdValue\": \"High\",\n                                    \"representation\": \"redBright\",\n                                    \"text\": \"{0}{1}\"\n                                  },\n                                  {\n                                    \"operator\": \"==\",\n                                    \"thresholdValue\": \"Medium\",\n                                    \"representation\": \"orange\",\n                                    \"text\": \"{0}{1}\"\n                                  },\n                                  {\n                                    \"operator\": \"==\",\n                                    \"thresholdValue\": \"Low\",\n                                    \"representation\": \"green\",\n                                    \"text\": \"{0}{1}\"\n                                  },\n                                  {\n                                    \"operator\": \"Default\",\n                                    \"thresholdValue\": null,\n                                    \"representation\": \"gray\",\n                                    \"text\": \"{0}{1}\"\n                                  }\n                                ]\n                              }\n                            },\n                            {\n                              \"columnMatch\": \"ImpactedField\",\n                              \"formatter\": 16,\n                              \"formatOptions\": {\n                                \"showIcon\": true\n                              }\n                            },\n                            {\n                              \"columnMatch\": \"ImpactedValue\",\n                              \"formatter\": 5\n                            },\n                            {\n                              \"columnMatch\": \"Description\",\n                              \"formatter\": 18,\n                              \"formatOptions\": {\n                                \"thresholdsOptions\": \"colors\",\n                                \"thresholdsGrid\": [\n                                  {\n                                    \"operator\": \"Default\",\n                                    \"thresholdValue\": null,\n                                    \"representation\": \"orange\",\n                                    \"text\": \"{0}{1}\"\n                                  }\n                                ]\n                              }\n                            },\n                            {\n                              \"columnMatch\": \"resourceGroup\",\n                              \"formatter\": 14,\n                              \"formatOptions\": {\n                                \"linkTarget\": null,\n                                \"showIcon\": true\n                              }\n                            },\n                            {\n                              \"columnMatch\": \"Category\",\n                              \"formatter\": 5\n                            },\n                            {\n                              \"columnMatch\": \"LastUpdated\",\n                              \"formatter\": 6\n                            }\n                          ],\n                          \"rowLimit\": 10000,\n                          \"hierarchySettings\": {\n                            \"treeType\": 1,\n                            \"groupBy\": [\n                              \"subscriptionId\",\n                              \"Impact\",\n                              \"Description\"\n                            ],\n                            \"finalBy\": \"ImpactedValue\"\n                          },\n                          \"labelSettings\": [\n                            {\n                              \"columnId\": \"ImpactedField\",\n                              \"label\": \"Resource Type\"\n                            },\n                            {\n                              \"columnId\": \"ImpactedValue\",\n                              \"label\": \"Resource\"\n                            },\n                            {\n                              \"columnId\": \"resourceGroup\",\n                              \"label\": \"Resource Group\"\n                            },\n                            {\n                              \"columnId\": \"LastUpdated\",\n                              \"label\": \"Last Updated\"\n                            }\n                          ]\n                        },\n                        \"sortBy\": []\n                      },\n                      \"name\": \"query - 0\"\n                    }\n              ]\n            },\n            \"name\": \"Advisor\"\n          }\n    ]\n}"
    }
  }
}
